from flask import Flask, request, jsonify
import joblib

model = joblib.load('./MalwareModel.joblib')

app = Flask(__name__)


@app.route('/', methods=['GET'])
def get():
    return jsonify({'HEHE':'Hello mf :)'})
    
    

@app.route('/model-predict', methods=['POST'])
def post():
    if request.method == 'POST':
        try:
            data = request.get_json()
            input_features = data.get('features')

            predictions = model.predict([input_features])

            return jsonify({'predictions': list(predictions)})
        except Exception as e:
            return {'Error': f'An Error Occured: {str(e)}'}, 500

if __name__ == '__main__':
    try:
        print('API ONLINE -- LISTENING ON PORT 8080')
        from waitress import serve
        serve(app, host="0.0.0.0", port=8080)
        print('API OFFLINE')
    except Exception as e:
        print(f'An Error Occoured: {e}')